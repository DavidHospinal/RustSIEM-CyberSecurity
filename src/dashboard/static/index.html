<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RustSIEM - Security Information & Event Management</title>
    <link rel="stylesheet" href="/static/style.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üîê</text></svg>">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
</head>
<body>
<div class="container">
    <!-- Header Principal -->
    <header class="header">
        <div class="header-content">
            <div class="logo-section">
                <h1 class="main-title">
                    <span class="logo">üõ°Ô∏è</span>
                    RustSIEM
                    <span class="subtitle">Security Information & Event Management</span>
                </h1>
            </div>
            <div class="header-info">
                <div class="last-updated">
                    <span>Last Updated:</span>
                    <span id="last-updated-time">--</span>
                </div>
                <div class="critical-alerts-badge">
                    <span id="critical-alerts-count">0</span>
                    <span>Critical Alerts</span>
                </div>
            </div>
        </div>

        <nav class="nav-menu">
            <a href="#dashboard" class="nav-link active" data-page="dashboard">
                <span class="nav-icon">üìä</span>
                Dashboard
            </a>
            <a href="#events" class="nav-link" data-page="events">
                <span class="nav-icon">üìã</span>
                Events
            </a>
            <a href="#alerts" class="nav-link" data-page="alerts">
                <span class="nav-icon">‚ö†Ô∏è</span>
                Alerts
            </a>
            <a href="#threat-hunt" class="nav-link" data-page="threat-hunt">
                <span class="nav-icon">üéØ</span>
                Threat Hunt
            </a>
            <a href="#reports" class="nav-link" data-page="reports">
                <span class="nav-icon">üìë</span>
                Reports
            </a>
        </nav>
    </header>

    <!-- Barra de Estado del Sistema -->
    <div class="status-bar">
        <span class="status-indicator" id="system-status"></span>
        <span class="status-text">System Status: <span id="system-status-text">Operational</span></span>
        <div class="status-details">
            <span>Events/sec: <span id="events-per-second">0</span></span>
            <span>Active Sources: <span id="active-sources">0</span></span>
            <span>Uptime: <span id="system-uptime">00:00:00</span></span>
        </div>
    </div>

    <!-- Contenido Principal -->
    <main id="main-content">
        <!-- Dashboard Principal -->
        <section id="dashboard-page" class="page-content active">
            <div class="analytics-header">
                <h2>üìä Analytics</h2>
            </div>

            <!-- M√©tricas Principales -->
            <div class="metrics-grid">
                <div class="metric-card" id="events-per-second-card">
                    <div class="metric-header">
                        <span class="metric-icon">‚ö°</span>
                        <span class="metric-title">
                            <div class="tooltip-container">
                                <span class="tooltip-term">Events per Second</span>
                                <div class="tooltip-content">
                                    <div class="tooltip-title">Eventos por Segundo (EPS)</div>
                                    <div class="tooltip-description">
                                        M√©trica que mide la velocidad de procesamiento de logs de seguridad. Un valor alto puede indicar un ataque en curso o problemas de rendimiento.
                                    </div>
                                    <div class="tooltip-examples">
                                        <div class="tooltip-examples-title">Valores t√≠picos:</div>
                                        <ul class="tooltip-examples-list">
                                            <li>1-10 EPS: Tr√°fico normal</li>
                                            <li>50-100 EPS: Actividad elevada</li>
                                            <li>500+ EPS: Posible ataque DDoS</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </span>
                    </div>
                    <div class="metric-value" id="metric-events-per-second">0.00</div>
                    <div class="metric-trend">
                        <span class="trend-text">+12% from last hour</span>
                    </div>
                </div>

                <div class="metric-card critical" id="critical-alerts-card">
                    <div class="metric-header">
                        <span class="metric-icon">üî¥</span>
                        <span class="metric-title">
                            <div class="tooltip-container">
                                <span class="tooltip-term">Critical Alerts</span>
                                <div class="tooltip-content">
                                    <div class="tooltip-title">Alertas Cr√≠ticas</div>
                                    <div class="tooltip-description">
                                        Eventos de seguridad que requieren respuesta inmediata. Indican compromiso activo o intento de ataque exitoso.
                                    </div>
                                    <div class="tooltip-examples">
                                        <div class="tooltip-examples-title">Ejemplos de alertas cr√≠ticas:</div>
                                        <ul class="tooltip-examples-list">
                                            <li>Inyecci√≥n SQL exitosa</li>
                                            <li>Acceso root no autorizado</li>
                                            <li>Exfiltraci√≥n de datos masiva</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </span>
                    </div>
                    <div class="metric-value" id="metric-critical-alerts">0</div>
                    <div class="metric-trend">
                        <span class="trend-text">SQL Injection detected</span>
                    </div>
                </div>

                <div class="metric-card warning" id="threat-score-card">
                    <div class="metric-header">
                        <span class="metric-icon">üéØ</span>
                        <span class="metric-title">
                            <div class="tooltip-container">
                                <span class="tooltip-term">Threat Score</span>
                                <div class="tooltip-content">
                                    <div class="tooltip-title">Puntuaci√≥n de Amenaza</div>
                                    <div class="tooltip-description">
                                        Algoritmo que combina m√∫ltiples indicadores para calcular el nivel de riesgo general del sistema. Escala 0-10.
                                    </div>
                                    <div class="tooltip-examples">
                                        <div class="tooltip-examples-title">Niveles de riesgo:</div>
                                        <ul class="tooltip-examples-list">
                                            <li>0-3: Riesgo bajo, operaci√≥n normal</li>
                                            <li>4-6: Riesgo medio, monitoreo requerido</li>
                                            <li>7-10: Riesgo alto, respuesta inmediata</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </span>
                    </div>
                    <div class="metric-value" id="metric-threat-score">0.0<span class="metric-unit">/10</span></div>
                    <div class="metric-trend">
                        <span class="trend-text">High risk detected</span>
                    </div>
                </div>

                <div class="metric-card" id="active-sources-card">
                    <div class="metric-header">
                        <span class="metric-icon">üì°</span>
                        <span class="metric-title">
                            <div class="tooltip-container">
                                <span class="tooltip-term">Active Log Sources</span>
                                <div class="tooltip-content">
                                    <div class="tooltip-title">Fuentes de Logs Activas</div>
                                    <div class="tooltip-description">
                                        N√∫mero de sistemas que est√°n enviando logs de seguridad al SIEM. Incluye servidores web, bases de datos, firewalls y otros componentes.
                                    </div>
                                    <div class="tooltip-examples">
                                        <div class="tooltip-examples-title">Tipos de fuentes comunes:</div>
                                        <ul class="tooltip-examples-list">
                                            <li>Apache/Nginx: Servidores web</li>
                                            <li>SSH: Servicios de acceso remoto</li>
                                            <li>MySQL/PostgreSQL: Bases de datos</li>
                                            <li>Firewall: Dispositivos de red</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </span>
                    </div>
                    <div class="metric-value" id="metric-active-sources">0</div>
                    <div class="metric-trend">
                        <span class="trend-text">All systems reporting</span>
                    </div>
                </div>
            </div>

            <!-- Stream de Eventos en Tiempo Real -->
            <div class="real-time-section">
                <div class="section-header">
                    <h3>üì° Real-time Event Stream</h3>
                    <div class="controls">
                        <button class="control-btn" id="pause-stream">
                            <span class="btn-icon">‚è∏Ô∏è</span>
                            Pause
                        </button>
                        <button class="control-btn" id="clear-stream">
                            <span class="btn-icon">üóëÔ∏è</span>
                            Clear
                        </button>
                    </div>
                </div>
                <div class="event-stream" id="event-stream">
                    <div class="stream-placeholder">
                        <span class="placeholder-icon">üì°</span>
                        <span>Waiting for events...</span>
                    </div>
                </div>
            </div>

            <!-- Patrones de Ataques -->
            <div class="attack-patterns-section">
                <div class="section-header">
                    <h3>üõ°Ô∏è Attack Patterns (Last 24h)</h3>
                </div>
                <div class="attack-patterns-grid">
                    <div class="pattern-card">
                        <div class="pattern-header">
                            <span class="pattern-icon">üíâ</span>
                            <span class="pattern-name">
                                <div class="tooltip-container">
                                    <span class="tooltip-term">SQL Injection</span>
                                    <div class="tooltip-content">
                                        <div class="tooltip-title">Inyecci√≥n SQL</div>
                                        <div class="tooltip-description">
                                            T√©cnica donde atacantes insertan c√≥digo SQL malicioso en campos de entrada para manipular bases de datos.
                                        </div>
                                        <div class="tooltip-examples">
                                            <div class="tooltip-examples-title">Payloads comunes:</div>
                                            <ul class="tooltip-examples-list">
                                                <li>' OR '1'='1'--</li>
                                                <li>'; DROP TABLE users;--</li>
                                                <li>' UNION SELECT password FROM admin--</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </span>
                        </div>
                        <div class="pattern-count" id="sql-injection-count">0</div>
                        <div class="pattern-bar">
                            <div class="pattern-progress" id="sql-injection-progress"></div>
                        </div>
                    </div>

                    <div class="pattern-card">
                        <div class="pattern-header">
                            <span class="pattern-icon">üîó</span>
                            <span class="pattern-name">
                                <div class="tooltip-container">
                                    <span class="tooltip-term">XSS</span>
                                    <div class="tooltip-content">
                                        <div class="tooltip-title">Cross-Site Scripting (XSS)</div>
                                        <div class="tooltip-description">
                                            Ataque que inyecta scripts maliciosos en sitios web para robar informaci√≥n de usuarios o ejecutar acciones no autorizadas.
                                        </div>
                                        <div class="tooltip-examples">
                                            <div class="tooltip-examples-title">Tipos de XSS:</div>
                                            <ul class="tooltip-examples-list">
                                                <li>Reflejado: Script en URL o formulario</li>
                                                <li>Almacenado: Script guardado en DB</li>
                                                <li>DOM: Manipulaci√≥n del DOM local</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </span>
                        </div>
                        <div class="pattern-count" id="xss-count">0</div>
                        <div class="pattern-bar">
                            <div class="pattern-progress" id="xss-progress"></div>
                        </div>
                    </div>

                    <div class="pattern-card">
                        <div class="pattern-header">
                            <span class="pattern-icon">üî®</span>
                            <span class="pattern-name">
                                <div class="tooltip-container">
                                    <span class="tooltip-term">Brute Force</span>
                                    <div class="tooltip-content">
                                        <div class="tooltip-title">Ataque de Fuerza Bruta</div>
                                        <div class="tooltip-description">
                                            M√©todo sistem√°tico que prueba m√∫ltiples combinaciones de credenciales hasta encontrar las correctas.
                                        </div>
                                        <div class="tooltip-examples">
                                            <div class="tooltip-examples-title">Objetivos comunes:</div>
                                            <ul class="tooltip-examples-list">
                                                <li>SSH: Acceso remoto a servidores</li>
                                                <li>RDP: Escritorio remoto Windows</li>
                                                <li>FTP: Transferencia de archivos</li>
                                                <li>Login web: Paneles de administraci√≥n</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </span>
                        </div>
                        <div class="pattern-count" id="brute-force-count">0</div>
                        <div class="pattern-bar">
                            <div class="pattern-progress" id="brute-force-progress"></div>
                        </div>
                    </div>

                    <div class="pattern-card">
                        <div class="pattern-header">
                            <span class="pattern-icon">üìà</span>
                            <span class="pattern-name">
                                <div class="tooltip-container">
                                    <span class="tooltip-term">DDoS</span>
                                    <div class="tooltip-content">
                                        <div class="tooltip-title">Ataques DDoS (Distributed Denial of Service)</div>
                                        <div class="tooltip-description">
                                            Ataques que buscan saturar un servicio con tr√°fico masivo para hacerlo inaccesible a usuarios leg√≠timos.
                                        </div>
                                        <div class="tooltip-examples">
                                            <div class="tooltip-examples-title">Tipos de ataques DDoS:</div>
                                            <ul class="tooltip-examples-list">
                                                <li>Volum√©tricos: Saturan el ancho de banda</li>
                                                <li>De protocolo: Explotan debilidades en protocolos</li>
                                                <li>De aplicaci√≥n: Atacan servicios espec√≠ficos</li>
                                                <li>Reflexi√≥n: Amplifican el tr√°fico usando terceros</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </span>
                        </div>
                        <div class="pattern-count" id="ddos-count">0</div>
                        <div class="pattern-bar">
                            <div class="pattern-progress" id="ddos-progress"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Amenazas Geogr√°ficas -->
            <div class="geographic-threats">
                <div class="section-header">
                    <h3>üåç Geographic Threats</h3>
                </div>
                <div class="threats-list" id="geographic-threats-list">
                    <!-- Se llena din√°micamente -->
                </div>
            </div>

            <!-- Machine Learning Anomalies -->
            <div class="ml-anomalies-section">
                <div class="section-header">
                    <h3>üß† ML Anomaly Detection</h3>
                </div>
                <div class="ml-status">
                    <div class="ml-model-status">
                        <span class="model-label">Model Status:</span>
                        <span class="model-status" id="ml-model-status">TRAINING</span>
                        <div class="training-progress">
                            <span class="progress-text">Training on 24h of normal traffic patterns...</span>
                            <div class="progress-bar">
                                <div class="progress-fill" id="ml-training-progress"></div>
                            </div>
                            <span class="progress-percent" id="ml-training-percent">80%</span>
                        </div>
                    </div>
                    <div class="anomalies-detected">
                        <h4>Anomalies Detected (Last Hour)</h4>
                        <div class="anomaly-list" id="anomaly-list">
                            <!-- Se llena din√°micamente -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Estado de Reglas de Detecci√≥n -->
            <div class="detection-rules-section">
                <div class="section-header">
                    <h3>‚öôÔ∏è Detection Rules Status</h3>
                    <button class="control-btn" id="add-rule-btn">
                        <span class="btn-icon">‚ûï</span>
                        Add New Rule
                    </button>
                </div>
                <div class="rules-grid" id="detection-rules-grid">
                    <!-- Se llena din√°micamente -->
                </div>
            </div>
        </section>

        <!-- P√°gina de Eventos -->
        <section id="events-page" class="page-content">
            <div class="page-header">
                <h2>üìã Security Events</h2>
                <div class="page-controls">
                    <input type="text" id="events-search" placeholder="Search events..." class="search-input">
                    <select id="events-filter" class="filter-select">
                        <option value="">All Severity Levels</option>
                        <option value="critical">Critical</option>
                        <option value="high">High</option>
                        <option value="medium">Medium</option>
                        <option value="low">Low</option>
                        <option value="info">Info</option>
                    </select>
                    <button class="control-btn" id="export-events">
                        <span class="btn-icon">üíæ</span>
                        Export
                    </button>
                </div>
            </div>
            <div class="events-table-container">
                <table class="events-table" id="events-table">
                    <thead>
                    <tr>
                        <th>Timestamp</th>
                        <th>Severity</th>
                        <th>Source</th>
                        <th>Event Type</th>
                        <th>Description</th>
                        <th>Actions</th>
                    </tr>
                    </thead>
                    <tbody id="events-table-body">
                    <!-- Se llena din√°micamente -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- P√°gina de Alertas -->
        <section id="alerts-page" class="page-content">
            <div class="page-header">
                <h2>‚ö†Ô∏è Security Alerts</h2>
                <div class="page-controls">
                    <select id="alerts-status-filter" class="filter-select">
                        <option value="">All Statuses</option>
                        <option value="active">Active</option>
                        <option value="acknowledged">Acknowledged</option>
                        <option value="resolved">Resolved</option>
                    </select>
                    <button class="control-btn" id="mark-all-read">
                        <span class="btn-icon">‚úÖ</span>
                        Mark All Read
                    </button>
                </div>
            </div>
            <div class="alerts-container" id="alerts-container">
                <!-- Se llena din√°micamente -->
            </div>
        </section>

        <!-- P√°gina de Threat Hunting -->
        <section id="threat-hunt-page" class="page-content">
            <div class="page-header">
                <h2>üéØ Threat Hunting</h2>
                <div class="page-controls">
                    <select id="hunt-category-filter" class="filter-select">
                        <option value="">Todas las Categor√≠as</option>
                        <option value="Data Exfiltration">Exfiltraci√≥n de Datos</option>
                        <option value="APT Detection">Detecci√≥n APT</option>
                        <option value="IOC Hunting">B√∫squeda IOC</option>
                    </select>
                    <button class="control-btn" id="new-hunt-btn">
                        <span class="btn-icon">üîç</span>
                        Nueva B√∫squeda
                    </button>
                </div>
            </div>

            <!-- Consultas de Hunting Predefinidas -->
            <div class="hunt-queries-section">
                <div class="section-header">
                    <h3>üîç Consultas de Hunting Disponibles</h3>
                    <div class="hunt-status">
                        <span class="status-indicator active"></span>
                        <span>Motor de Hunting: Activo</span>
                    </div>
                </div>
                <div class="hunt-queries-grid" id="hunt-queries-grid">
                    <!-- Se llena din√°micamente -->
                </div>
            </div>

            <!-- Resultados de Hunting Activos -->
            <div class="active-hunts-section">
                <div class="section-header">
                    <h3>üìä Resultados de Hunting</h3>
                </div>
                <div class="hunt-results-container" id="hunt-results-container">
                    <!-- Se llena din√°micamente -->
                </div>
            </div>

            <!-- IOCs (Indicadores de Compromiso) -->
            <div class="iocs-section">
                <div class="section-header">
                    <h3>üî¥ Indicadores de Compromiso (IOCs)</h3>
                    <button class="control-btn" id="add-ioc-btn">
                        <span class="btn-icon">‚ûï</span>
                        A√±adir IOC
                    </button>
                </div>
                <div class="iocs-table-container">
                    <table class="iocs-table" id="iocs-table">
                        <thead>
                        <tr>
                            <th>Tipo</th>
                            <th>Valor</th>
                            <th>Nivel de Amenaza</th>
                            <th>Fuente</th>
                            <th>√öltima Detecci√≥n</th>
                            <th>Acciones</th>
                        </tr>
                        </thead>
                        <tbody id="iocs-table-body">
                        <!-- Se llena din√°micamente -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- An√°lisis MITRE ATT&CK -->
            <div class="mitre-analysis-section">
                <div class="section-header">
                    <h3>üõ°Ô∏è Mapeo MITRE ATT&CK</h3>
                </div>
                <div class="mitre-tactics-grid" id="mitre-tactics-grid">
                    <!-- Se llena din√°micamente -->
                </div>
            </div>
        </section>

        <section id="reports-page" class="page-content">
            <div class="page-header">
                <h2>üìë Reports & Analytics</h2>
                <p>Comprehensive security insights and trend analysis</p>
            </div>
            
            <!-- Reports Content -->
            <div class="reports-content">
                <!-- Chart Grid -->
                <div class="charts-grid">
                    <!-- Events by Type Chart -->
                    <div class="chart-container">
                        <div class="chart-header">
                            <h3>üìä Events by Type Distribution</h3>
                            <p>Real-time breakdown of security events by category</p>
                        </div>
                        <div class="chart-wrapper">
                            <canvas id="events-type-chart" width="400" height="200"></canvas>
                        </div>
                    </div>

                    <!-- Threat Trends Chart -->
                    <div class="chart-container large">
                        <div class="chart-header">
                            <h3>üìà Threat Trends Over Time</h3>
                            <p>Security incidents timeline and evolution</p>
                        </div>
                        <div class="chart-wrapper">
                            <canvas id="threat-trends-chart" width="800" height="300"></canvas>
                        </div>
                    </div>

                    <!-- Geographic Heatmap -->
                    <div class="chart-container">
                        <div class="chart-header">
                            <h3>üåç Geographic Threat Distribution</h3>
                            <p>Attack sources by country and region</p>
                        </div>
                        <div id="geographic-heatmap" class="heatmap-container">
                            <!-- Populated dynamically -->
                        </div>
                    </div>

                    <!-- ML Performance Metrics -->
                    <div class="chart-container">
                        <div class="chart-header">
                            <h3>üß† ML Model Performance</h3>
                            <p>Machine learning detection accuracy and metrics</p>
                        </div>
                        <div class="ml-metrics-grid">
                            <div class="ml-metric">
                                <div class="metric-label">Accuracy</div>
                                <div class="metric-value" id="ml-accuracy-display">--</div>
                            </div>
                            <div class="ml-metric">
                                <div class="metric-label">Precision</div>
                                <div class="metric-value" id="ml-precision-display">--</div>
                            </div>
                            <div class="ml-metric">
                                <div class="metric-label">Recall</div>
                                <div class="metric-value" id="ml-recall-display">--</div>
                            </div>
                            <div class="ml-metric">
                                <div class="metric-label">F1-Score</div>
                                <div class="metric-value" id="ml-f1-score-display">--</div>
                            </div>
                            <div class="ml-metric">
                                <div class="metric-label">FP Rate</div>
                                <div class="metric-value" id="ml-fp-rate-display">--</div>
                            </div>
                            <div class="ml-metric">
                                <div class="metric-label">Training Samples</div>
                                <div class="metric-value" id="ml-training-samples-display">--</div>
                            </div>
                        </div>
                    </div>

                    <!-- False Positives Dashboard -->
                    <div class="chart-container large">
                        <div class="chart-header">
                            <h3>üéØ False Positives Analysis</h3>
                            <p>ML-powered false positive detection and mitigation</p>
                        </div>
                        <div class="fp-dashboard">
                            <div class="fp-summary">
                                <div class="fp-stat">
                                    <div class="fp-stat-value" id="total-false-positives">--</div>
                                    <div class="fp-stat-label">Total False Positives</div>
                                </div>
                                <div class="fp-stat">
                                    <div class="fp-stat-value" id="fp-reduction-percentage">--</div>
                                    <div class="fp-stat-label">Reduction Rate</div>
                                </div>
                                <div class="fp-stat">
                                    <div class="fp-stat-value" id="automated-mitigations">--</div>
                                    <div class="fp-stat-label">Automated Mitigations</div>
                                </div>
                                <div class="fp-stat">
                                    <div class="fp-stat-value" id="manual-markings">--</div>
                                    <div class="fp-stat-label">Manual Markings</div>
                                </div>
                            </div>
                            <div class="fp-patterns-section">
                                <h4>Common False Positive Patterns</h4>
                                <div id="fp-patterns-container" class="fp-patterns-list">
                                    <!-- Populated dynamically -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Report Actions -->
                <div class="report-actions">
                    <button class="control-btn" onclick="dashboard.loadReportsData()">
                        üîÑ Refresh Data
                    </button>
                    <button class="control-btn secondary" onclick="dashboard.exportMLReport()">
                        üìä Export ML Report
                    </button>
                    <button class="control-btn secondary" onclick="window.print()">
                        üñ®Ô∏è Print Report
                    </button>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <span>RustSIEM v1.0.0 | Built with Rust + Warp | Processing 2.8K events/sec</span>
            <div class="footer-info">
                <span>System Load: 23% | Memory: 2.1GB</span>
            </div>
        </div>
    </footer>
</div>

<!-- Loading Overlay -->
<div id="loading-overlay" class="loading-overlay">
    <div class="loading-spinner">
        <div class="spinner"></div>
        <div class="loading-text">Loading RustSIEM...</div>
    </div>
</div>

<!-- Scripts -->
<script src="/static/script.js"></script>
</body>
</html>